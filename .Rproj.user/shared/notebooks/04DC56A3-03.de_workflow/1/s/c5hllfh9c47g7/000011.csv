"0","if (file.exists(dds_file)){
    dds <- readRDS(dds_file)
}else{
    dds <- DESeqDataSetFromMatrix(countData = counts, 
                              colData = metadata, 
                              design = ~treatment)

    
    # subset protein-coding genes
    pc_genes <- intersect(protein_coding_genes$ensembl_gene_id, row.names(dds))
    dds <- dds[pc_genes,]
    # 9509 genes left
    keep <- rowMeans(counts(dds)) >= 100
    dds <- dds[keep, ]

    # Run DESeq2
    dds <- DESeq(dds)
    saveRDS(dds, dds_file)
}
"
"2","converting counts to integer mode
"
"2","Warning: some variables in design formula are characters, converting to factors"
"2","estimating size factors
"
"2","estimating dispersions
"
"2","gene-wise dispersion estimates
"
"2","mean-dispersion relationship
"
"2","final dispersion estimates
"
"2","fitting model and testing
"
"2","-- replacing outliers and refitting for 15 genes
-- DESeq argument 'minReplicatesForReplace' = 7 
-- original counts are preserved in counts(dds)
"
"2","estimating dispersions
"
"2","fitting model and testing
"
"2","Warning: cannot open compressed file '../../data/dds.RDS', probable reason 'No such file or directory'"
"2","Error in gzfile(file, mode) : cannot open the connection
"
